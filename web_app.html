<html>
<head>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
    }

    .container {
      display: flex;
      flex-direction: row;
      justify-content: space-around;
      align-items: center;
      height: 100vh;
    }

    .item {
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .icon {
      font-size: 64px;
    }

    .title {
      font-size: 24px;
    }

    .button {
      width: 80px;
      height: 40px;
      border: none;
      border-radius: 20px;
      background-color: #0088cc;
      color: white;
      font-size: 16px;
    }

    .button-group {
      display: flex;
      flex-direction: row;
    }

    .counter {
      position: absolute;
      top: 10px;
      right: 10px;
      width: 30px;
      height: 30px;
      border-radius: 15px;
      background-color: #ff0000;
      color: white;
      font-size: 16px;
      text-align: center;
      line-height: 30px;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="item" id="item1">
      <div class="icon">ðŸ¤–</div>
      <div class="title">ChatGPT</div>
      <div class="button-group">
        <button class="button" id="add1">Add</button>
        <button class="button" id="minus1" style="display:none;">-</button>
        <button class="button" id="plus1" style="display:none;">+</button>
        <div class="counter" id="count1" style="display:none;">0</div>
      </div>
    </div>
    <div class="item" id="item2">
      <div class="icon">ðŸŒ„</div>
      <div class="title">DALL-E</div>
      <div class="button-group">
        <button class="button" id="add2">Add</button>
        <button class="button" id="minus2" style="display:none;">-</button>
        <button class="button" id="plus2" style="display:none;">+</button>
        <div class="counter" id="count2" style="display:none;">0</div>
      </div>
    </div>
  </div>

  <script>

    // Initialize the Web App
    window.Telegram.WebApp.init();

    // Get the elements by id
    var item1 = document.getElementById("item1");
    var item2 = document.getElementById("item2");
    var add1 = document.getElementById("add1");
    var add2 = document.getElementById("add2");
    var minus1 = document.getElementById("minus1");
    var minus2 = document.getElementById("minus2");
    var plus1 = document.getElementById("plus1");
    var plus2 = document.getElementById("plus2");
    var count1 = document.getElementById("count1");
    var count2 = document.getElementById("count2");

    // Define the prices and quantities of the items
    var price1 = 10; // ChatGPT price in USD
    var price2 = 20; // DALL-E price in USD
    var quantity1 = 0; // ChatGPT quantity
    var quantity2 = 0; // DALL-E quantity

    // Define a function to update the UI based on the quantities
    function updateUI() {
      
      // Show or hide the buttons and counters based on the quantities
      if (quantity1 > 0) {
        add1.style.display = "none";
        minus1.style.display = "inline-block";
        plus1.style.display = "inline-block";
        count1.style.display = "inline-block";
        count1.innerHTML = quantity1;
      } else {
        add1.style.display = "inline-block";
        minus1.style.display = "none";
        plus1.style.display = "none";
        count1.style.display = "none";
      }

      if (quantity2 > 0) {
        add2.style.display = "none";
        minus2.style.display = "inline-block";
        plus2.style.display = "inline-block";
        count2.style.display = "inline-block";
        count2.innerHTML = quantity2;
      } else {
        add2.style.display = "inline-block";
        minus2.style.display = "none";
        plus2.style.display = "none";
        count2.style.display = "none";
      }

      // Calculate the total amount and the invoice payload
      var total = quantity1 * price1 + quantity2 * price2;
      var payload = JSON.stringify({
        chatGPT: quantity1,
        DALL-E: quantity2
      });

      // Show or hide the pay button based on the total amount
      if (total > 0) {
        window.Telegram.WebApp.showPayButton({
          title: "Pay",
          description: `You have selected ${quantity1} ChatGPT and ${quantity2} DALL-E`,
          amount: total * 100, // amount in cents
          currency: "USD",
          payload: payload,
          provider_token: "<your provider token>",
          start_parameter: "<your start parameter>",
          prices: [
            {label: "ChatGPT", amount: quantity1 * price1 * 100},
            {label: "DALL-E", amount: quantity2 * price2 * 100}
          ]
        });
      } else {
        window.Telegram.WebApp.hidePayButton();
      }
    }

    // Define the event listeners for the buttons
    add1.addEventListener("click", function() {
      quantity1++;
      updateUI();
    });

    add2.addEventListener("click", function() {
      quantity2++;
      updateUI();
    });

    minus1.addEventListener("click", function() {
      if (quantity1 > 0) {
        quantity1--;
        updateUI();
      }
    });

    minus2.addEventListener("click", function() {
      if (quantity2 > 0) {
        quantity2--;
        updateUI();
      }
    });

    plus1.addEventListener("click", function() {
      quantity1++;
      updateUI();
    });

    plus2.addEventListener("click", function() {
      quantity2++;
      updateUI();
    });

    // Update the UI initially
    updateUI();

  </script>
</body>
</html>
